<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Unlight</title>
<style>
.wrapper {
	position: absolute;
	left: 0px;
	top: 0px;
	width: 500px;
	height: 800px;
	background: #000;
}
</style>
</head>
<body width="100%" height="100%">
</body>
<script>
/*******************************************************************************
 *	Logs
 */
/*******************************************************************************
 *	Utils
 */
var eventDispatcher = (function () {
	var inst = {};
	var map = {};
	var dispose = function () {
		inst = null;
		map = null;
	};
	var add = function ( action, listener ) {
		if ( !map || typeof action !== 'string' || action === '' || typeof listener !== 'function' ) {
			return;
		}
		if ( !map[action] ) {
			map[action] = [];
		}
		map[action].push( listener );
	};
	var remove = function ( action, listener ) {
		if ( !map ) {
			return;
		}
		if ( typeof action !== 'string' || action === '' ) {
			map = {};
			return;
		}
		if ( !map[action] ) {
			return;
		}
		if ( typeof listener !== 'function' ) {
			map[action] = [];
			return;
		}
		var i = 0;
		var list = map[action];
		for(i = 0; i < list.length; i++) {
			if ( list[i] === listener ) {
				list.splice( i, 1 );
				return;
			}
		}
	};
	var dispatch = function ( action, data ) {
		if ( !map || typeof action !== 'string' || action === '' || !map[action] ) {
			return;
		}
		var i = 0;
		var list = map[action];
		for(i = 0; i < list.length; i++) {
			var listener = list[i];
			listener( data );
		}
	};
	inst.dispose = dispose;
	inst.add = add;
	inst.dispatch = dispatch;
	inst.remove = remove;
	return inst;
}());

var createFlow = function () {
	var inst = {};
	return inst;
};

var hasProp = {}.hasOwnProperty;

var isObjWithKey = function ( obj, key ) {
	if ( typeof obj !== 'object' ) {
		return false;
	}
	if ( obj === null ) {
		return false;
	}
	return hasProp.call( obj, key );
};

var log = function ( value ) {
	console.log( value );
};
/*******************************************************************************
 *	Data
 */
	
var ActionCardType = {};
ActionCardType.ANY = 1;
ActionCardType.SWORD = 2;
ActionCardType.GUN = 3;
ActionCardType.SHIELD = 4;
ActionCardType.MOVE = 5;
ActionCardType.STAR = 6;
ActionCardType.HEAL = 7;
ActionCardType.DETOX = 8;
ActionCardType.DRAW = 9;
ActionCardType.THROW = 10;

var ActionCardStage = {};
ActionCardStage.FREE = 1; // move / atk / guard
ActionCardStage.FIGHT = 2; // atk / guard

var SkillTriggerStage = {};
SkillTriggerStage.MOV = 'MOV';
SkillTriggerStage.ATK = 'ATK';
SkillTriggerStage.DEF = 'DEF';
SkillTriggerStage.ALL = 'ALL';

var SkillTriggerDistance = {};
SkillTriggerDistance.S = 'S';
SkillTriggerDistance.M = 'M';
SkillTriggerDistance.SM = 'SM';
SkillTriggerDistance.L = 'L';
SkillTriggerDistance.SL = 'SL';
SkillTriggerDistance.ML = 'ML';
SkillTriggerDistance.SML = 'SML';

var SkillCardCalc = {};
SkillCardCalc.SUM_MIN = 'SUM_MIN';
SkillCardCalc.SUM_EQU = 'SUM_EQU';
SkillCardCalc.SUM_MAX = 'SUM_MAX';
SkillCardCalc.ONE_MIN = 'ONE_MIN';
SkillCardCalc.ONE_EQU = 'ONE_EQU';
SkillCardCalc.ONE_MAX = 'ONE_MAX';

var SkillResultStage = {};
SkillResultStage.ATK_DAMAGE_CALCED_A = 'ATK_DAMAGE_CALCED_A';
SkillResultStage.ATK_INC_A = 'ATK_INC_A';
SkillResultStage.ATK_THROW_CARD_A = 'ATK_THROW_CARD_A';
SkillResultStage.DEF_COUNTERATK_A = 'DEF_COUNTERATK_A';
SkillResultStage.DEF_INC_A = 'DEF_INC_A';
SkillResultStage.DEF_OVERCOME_CALCED_A = 'DEF_OVERCOME_CALCED_A';
SkillResultStage.MOV_BEFORE_ACT_A = 'MOV_BEFORE_ACT_A';

var SkillResultTarget = {};
SkillResultTarget.ATK_ATKPOWER = 'ATK_ATKPOWER';
SkillResultTarget.ATK_HP = 'ATK_HP';
SkillResultTarget.ATK_CARDHOLD = 'ATK_CARDHOLD';
SkillResultTarget.DEF_DEFPOWER = 'DEF_DEFPOWER';
SkillResultTarget.DEF_HP = 'DEF_HP';
SkillResultTarget.DEF_CARDHOLD = 'DEF_CARDHOLD';
SkillResultTarget.VARIBLE = 'VARIBLE';

var SkillResultCalc = {};
SkillResultCalc.CARDHOLD_ADD_BYCONST = 'CARDHOLD_ADD_BYCONST';
SkillResultCalc.CARDHOLD_THROW_BYVAR = 'CARDHOLD_THROW_BYVAR';
SkillResultCalc.VALUE_ADD_BYCONST = 'VALUE_ADD_BYCONST';
SkillResultCalc.VALUE_ADD_BYVAR = 'VALUE_ADD_BYVAR';
SkillResultCalc.VALUE_MINUS_BYCONST = 'VALUE_ADD_BYCONST';
SkillResultCalc.VALUE_MINUS_BYVAR = 'VALUE_ADD_BYVAR';
SkillResultCalc.VAR_SET_BYATK_DAMAGE_CALCED = 'VAR_SET_BYATK_DAMAGE_CALCED';
SkillResultCalc.VAR_SET_BYATK_HURT_AMOUNT = 'VAR_SET_BYATK_HURT_AMOUNT';
SkillResultCalc.VAR_SET_BYATK_SWORD_AMOUNT = 'VAR_SET_BYATK_SWORD_AMOUNT';
SkillResultCalc.VAR_SET_BYDEF_OVERCOME_CALCED = 'VAR_SET_BYDEF_OVERCOME_CALCED';

var SkillVarible = {};
SkillVarible.COUNTER_ATK = 'COUNTER_ATK';
SkillVarible.HURT_AMOUNT = 'HURT_AMOUNT';
SkillVarible.SWORD_AMOUNT = 'SWORD_AMOUNT';
SkillVarible.THROW_CARD = 'THROW_CARD';

var Const = {};

var dataBase = (function () {
	var inst = {};
	
	var createTable = function ( _keyName ) {
		var inst = {};
		var dataArr = [];
		var idxMap = {};
		var keyName = _keyName;
		
		var dispose = function () {
			inst = null;
			dataArr = null;
			idxMap = null;
		};
		
		var selectByKey = function ( _key ) {
			if ( !inst ) {
				return null;
			}
			if ( !hasProp.call( idxMap, _key ) ) {
				return null;
			}
			var idx = idxMap[_key];
			var item = dataArr[idx];
			var rslt = {};
			for(var key in item) {
				rslt[key] = item[key];
			}
			return rslt;
		};
		
		var getSize = function () {
			if ( !inst ) {
				return 0;
			}
			return dataArr.length;
		};
		
		var insert = function ( data ) {
			if ( !inst || !isObjWithKey( data, keyName ) ) {
				return false;
			}
			
			var key = data[keyName];
			if ( hasProp.call( idxMap, key ) ) {
				var idx = idxMap[key];
				dataArr[idx] = data;
			} else {
				idxMap[key] = dataArr.length;
				dataArr.push( data );
			}
		};
		
		inst.dispose = dispose;
		inst.getSize = getSize;
		inst.insert = insert;
		inst.selectByKey = selectByKey;
		return inst;
	};
	
	var actionCards = (function () {
		var inst = {};
		
		var generateCardId = function ( type0, value0, type1, value1 ) {
			var t0 = type0;
			var v0 = value0;
			var t1 = type1;
			var v1 = value1;
			if ( t0 < t1 || ( t0 === t1 && v0 > v1 ) ) {
				t0 = type1;
				v0 = value1;
				t1 = type0;
				t1 = value0;
			}
			if ( t1 === 0 ) {
				t1 = 0;
				v1 = v0;
			}
			return type0 * 1000 + type1 * 100 + value0 * 10 + value1;
		};
		
		var typeTable = (function () {
			var table = createTable( 'id' );
			
			var insert = function ( id, name, stage, remark ) {
				table.insert( { id: id, name: name, stage: stage, remark: remark } );
			};
			
			insert( ActionCardType.SWORD,	'Sword', ActionCardStage.FREE, '' );
			insert( ActionCardType.GUN,	'Gun', ActionCardStage.FREE, '' );
			insert( ActionCardType.SHIELD,	'Shield', ActionCardStage.FREE, '' );
			insert( ActionCardType.MOVE,	'Move', ActionCardStage.FREE, '' );
			insert( ActionCardType.STAR,	'Star', ActionCardStage.FREE, '' );
			insert( ActionCardType.HEAL,	'Heal', ActionCardStage.FREE, '' );
			insert( ActionCardType.DETOX,	'Detoxification', ActionCardStage.FREE, '' );
			insert( ActionCardType.DRAW,	'Draw cards', ActionCardStage.FREE, '' );
			insert( ActionCardType.THROW,	'Throw cards', ActionCardStage.FIGHT, '' );
			
			log( 'db - typeTable >> ' + table.getSize() );
			return table;
		} ());
		
		var cardTable = (function () {
			var table = createTable( 'id' );
			
			var insert = function ( type0, value0, type1, value1 ) {
				var id = generateCardId( type0, value0, type1, value1 );
				table.insert( { id: id, type0: type0, value0: value0, type1: type1, value1: value1 } );
			};
			
			var i = 0;
			var j = 0;
			var k = 0;
			var m = 0;
			
			for(i = 0; i <= 4; i++) {
				for(j = i; j <= 4; j++) {
					var t0 = 0;
					var t1 = 0;
					switch ( i ) {
					case 0: t0 = ActionCardType.SWORD; break;
					case 1: t0 = ActionCardType.GUN; break;
					case 2: t0 = ActionCardType.SHIELD; break;
					case 3: t0 = ActionCardType.MOVE; break;
					case 4: t0 = ActionCardType.STAR; break;
					}
					switch ( j ) {
					case 0: t1 = ActionCardType.SWORD; break;
					case 1: t1 = ActionCardType.GUN; break;
					case 2: t1 = ActionCardType.SHIELD; break;
					case 3: t1 = ActionCardType.MOVE; break;
					case 4: t1 = ActionCardType.STAR; break;
					}
					for(k = 0; k <= 9; k++) {
						for(m = k; m <= 9; m++) {
							insert( t0, k, t1, m );
						}
					}
				}
			}
			
			for(i = 1; i <= 9; i++) {
				insert( ActionCardType.HEAL, i, 0, 0 );
				insert( ActionCardType.DETOX, i, 0, 0 );
				insert( ActionCardType.DRAW, i, 0, 0 );
				insert( ActionCardType.THROW, i, 0, 0 );
			}
			
			log( 'db - cardTable >> ' + table.getSize() );
			return table;
		} ());
		
		var cardSetTable = (function () {
			var table = createTable( 'id' );
			
			var insert = function ( id, list ) {
				table.insert( { id: id, list: list } );
			};
			
			insert( 1, [
				  { id: generateCardId( ActionCardType.MOVE, 1, ActionCardType.GUN, 1 ), num: 6 }
				, { id: generateCardId( ActionCardType.MOVE, 1, ActionCardType.GUN, 2 ), num: 2 }
				, { id: generateCardId( ActionCardType.MOVE, 1, ActionCardType.GUN, 3 ), num: 2 }
				, { id: generateCardId( ActionCardType.MOVE, 1, ActionCardType.SHIELD, 1 ), num: 6 }
				, { id: generateCardId( ActionCardType.MOVE, 1, ActionCardType.SHIELD, 2 ), num: 2 }
				, { id: generateCardId( ActionCardType.MOVE, 1, ActionCardType.SHIELD, 3 ), num: 1 }
				, { id: generateCardId( ActionCardType.MOVE, 2, ActionCardType.STAR, 3 ), num: 3 }
				, { id: generateCardId( ActionCardType.SWORD, 1, ActionCardType.SHIELD, 1 ), num: 4 }
				, { id: generateCardId( ActionCardType.SWORD, 2, ActionCardType.SHIELD, 1 ), num: 2 }
				, { id: generateCardId( ActionCardType.SWORD, 2, ActionCardType.SHIELD, 2 ), num: 2 }
				, { id: generateCardId( ActionCardType.SWORD, 3, ActionCardType.SHIELD, 3 ), num: 2 }
				, { id: generateCardId( ActionCardType.SHIELD, 5, 0, 0 ), num: 1 }
				, { id: generateCardId( ActionCardType.SWORD, 1, ActionCardType.GUN, 1 ), num: 4 }
				, { id: generateCardId( ActionCardType.SWORD, 2, ActionCardType.GUN, 1 ), num: 2 }
				, { id: generateCardId( ActionCardType.SWORD, 2, ActionCardType.GUN, 2 ), num: 2 }
				, { id: generateCardId( ActionCardType.SWORD, 3, ActionCardType.GUN, 3 ), num: 2 }
				, { id: generateCardId( ActionCardType.SWORD, 6, 0, 0 ), num: 1 }
				, { id: generateCardId( ActionCardType.SWORD, 1, ActionCardType.STAR, 1 ), num: 1 }
				, { id: generateCardId( ActionCardType.SWORD, 2, ActionCardType.STAR, 1 ), num: 1 }
				, { id: generateCardId( ActionCardType.SWORD, 4, ActionCardType.STAR, 1 ), num: 2 }
				, { id: generateCardId( ActionCardType.SWORD, 5, ActionCardType.STAR, 2 ), num: 2 }
				, { id: generateCardId( ActionCardType.GUN, 4, 0, 0 ), num: 1 }
				, { id: generateCardId( ActionCardType.GUN, 2, ActionCardType.STAR, 1 ), num: 1 }
				, { id: generateCardId( ActionCardType.GUN, 3, ActionCardType.STAR, 2 ), num: 1 }
				, { id: generateCardId( ActionCardType.GUN, 4, ActionCardType.STAR, 1 ), num: 2 }
				, { id: generateCardId( ActionCardType.GUN, 5, ActionCardType.STAR, 2 ), num: 2 }
			] )
			
			log( 'db - cardSetTable >> ' + table.getSize() );
			return table;
		} ());
		
		inst.type = typeTable;
		inst.card = cardTable;
		inst.cardSet = cardSetTable;
		
		return inst;
	} ());

	var charCards = (function () {
		var inst = {};
		
		var skillResultTable = (function () {
			var table = createTable( 'id' );
			
			var insert = function ( id, list ) {
				table.insert( { id: id, list: list } );
			};
			
			insert( 'Attack', [
				{stage: SkillResultStage.ATK_INC_A, target: SkillResultTarget.ATK_ATKPOWER, calc: SkillResultCalc.VALUE_ADD_BYCONST, value: 'a'}
			] );
			insert( 'Lightning', [
				{stage: SkillResultStage.ATK_INC_A, target: SkillResultTarget.ATK_ATKPOWER, calc: SkillResultCalc.VALUE_ADD_BYCONST, value: 'a'},
				{stage: SkillResultStage.ATK_DAMAGE_CALCED_A, target: SkillResultTarget.VARIBLE, calc: SkillResultCalc.VAR_SET_BYATK_DAMAGE_CALCED, varible: SkillVarible.THROW_CARD},
				{stage: SkillResultStage.ATK_THROW_CARD_A, target: SkillResultTarget.DEF_CARDHOLD, calc: SkillResultCalc.CARDHOLD_THROW_BYVAR, varible: SkillVarible.THROW_CARD}
			] );
			insert( 'Thorns', [
				{stage: SkillResultStage.DEF_INC_A, target: SkillResultTarget.DEF_DEFPOWER, calc: SkillResultCalc.VALUE_ADD_BYCONST, value: 'a'},
				{stage: SkillResultStage.DEF_OVERCOME_CALCED_A, target: SkillResultTarget.VARIBLE, calc: SkillResultCalc.VAR_SET_BYDEF_OVERCOME_CALCED, varible: SkillVarible.COUNTER_ATK},
				{stage: SkillResultStage.DEF_COUNTERATK_A, target: SkillResultTarget.ATK_HP, calc: SkillResultCalc.VALUE_MINUS_BYVAR, varible: SkillVarible.COUNTER_ATK},
			] );
			insert( 'Strategy', [
				{stage: SkillResultStage.MOV_BEFORE_ACT_A, target: SkillResultTarget.ATK_CARDHOLD, calc: SkillResultCalc.CARDHOLD_ADD_BYCONST, value: 'a'}
			] );
			insert( 'AttackAddSword', [
				{stage: SkillResultStage.ATK_PREPARE_A, target: SkillResultTarget.VARIBLE, calc: SkillResultCalc.VAR_SET_BYATK_SWORD_AMOUNT, varible: SkillVarible.SWORD_AMOUNT}
				{stage: SkillResultStage.ATK_INC_A, target: SkillResultTarget.ATK_ATKPOWER, calc: SkillResultCalc.VALUE_ADD_BYVAR, varible: SkillVarible.SWORD_AMOUNT}
			] );
			insert( 'AttackAddHurt', [
				{stage: SkillResultStage.ATK_PREPARE_A, target: SkillResultTarget.VARIBLE, calc: SkillResultCalc.VAR_SET_BYATK_HURT_AMOUNT, varible: SkillVarible.HURT_AMOUNT}
				{stage: SkillResultStage.ATK_INC_A, target: SkillResultTarget.ATK_ATKPOWER, calc: SkillResultCalc.VALUE_ADD_BYVAR, varible: SkillVarible.HURT_AMOUNT}
			] );
		});
		
		var skillTable = (function () {
			var table = createTable( 'id' );
			
			var insert = function ( id, name, triggerStage, triggerDistance, triggerCards, eventResultId, eventResultValue ) {
				table.insert( { id: id, name: name, triggerStage: triggerStage, triggerDistance: triggerDistance, triggerCards: triggerCards, eventResultId: eventResultId, eventResultValue: eventResultValue } );
			};
			
			insert( 1, 'Shoot', SkillTriggerStage.ATK, SkillTriggerDistance.ML,
				[
					{card: ActionCardType.GUN, num: 4, calc: SkillCardCalc.SUM_MIN}
				], 'Attack', { a: 4 }
			);
			insert( 2, 'Lightning', SkillTriggerStage.ATK, SkillTriggerDistance.S,
				[
					{card: ActionCardType.STAR, num: 2, calc: SkillCardCalc.SUM_MIN}
				], 'Lightning', { a: 4 }
			);
			insert( 3, 'Thorns', SkillTriggerStage.DEF, SkillTriggerDistance.SM,
				[
					{card: ActionCardType.SHIELD, num: 3, calc: SkillCardCalc.SUM_MIN},
					{card: ActionCardType.STAR, num: 2, calc: SkillCardCalc.SUM_MIN}
				], 'Thorns', { a: 4 }
			);
			insert( 4, 'Strategy', SkillTriggerStage.MOV, SkillTriggerDistance.SML,
				[
					{card: ActionCardType.ANY, num: 1, calc: SkillCardCalc.ONE_MIN},
					{card: ActionCardType.ANY, num: 1, calc: SkillCardCalc.ONE_MIN},
					{card: ActionCardType.ANY, num: 1, calc: SkillCardCalc.ONE_MIN}
				], 'Strategy', { a: 2 }
			);
			insert( 5, 'DoubleShoot', SkillTriggerStage.ATK, SkillTriggerDistance.ML,
				[
					{card: ActionCardType.GUN, num: 1, calc: SkillCardCalc.ONE_EQU},
					{card: ActionCardType.GUN, num: 1, calc: SkillCardCalc.ONE_EQU}
				], 'Attack', { a: 5 }
			);
			insert( 6, 'QuickCut', SkillTriggerStage.ATK, SkillTriggerDistance.ML,
				[
					{card: ActionCardType.SWORD, num: 1, calc: SkillCardCalc.SUM_MIN}
				], 'AttackAddSword', {}
			);
			insert( 7, 'Angry', SkillTriggerStage.ATK, SkillTriggerDistance.S,
				[
					{card: ActionCardType.STAR, num: 3, calc: SkillCardCalc.SUM_MIN}
				], 'AttackAddHurt', {}
			);
			
			log( 'db - skillTable >> ' + table.getSize() );
			return table;
		} ());
		
		var charGroupTable = (function () {
			var table = createTable( 'id' );
			
			var insert = function ( id, name ) {
				table.insert( { id: id, name: name } );
			};
			
			insert( 1, 'Evarist' );
			insert( 2, 'Izzac' );
			
			log( 'db - charGroupTable >> ' + table.getSize() );
			return table;
		} ());
		
		var charTable = (function () {
			var table = createTable( 'id' );
			
			var insert = function ( id, gid, level, hp, atk, def, skills ) {
				table.insert( { id: id, gid: gid, level: level, hp: hp, atk: atk, def: def, skills: skills } );
			};
			
			insert( 101, 1, 1, 8, 5, 6, [1] );
			insert( 102, 1, 2, 9, 5, 7, [1, 2] );
			insert( 103, 1, 3, 10, 6, 7, [1, 2, 3] );
			insert( 104, 1, 4, 12, 8, 8, [1, 2, 3] );
			insert( 105, 1, 5, 12, 9, 9, [1, 2, 3, 4] );
			insert( 201, 2, 1, 8, 5, 6, [5] );
			insert( 202, 2, 2, 9, 5, 7, [5, 6] );
			insert( 203, 2, 3, 10, 6, 7, [5, 6, 7] );
			insert( 204, 2, 4, 12, 8, 8, [5, 6, 7] );
			insert( 205, 2, 5, 12, 9, 9, [5, 6, 7, 8] );
			
			log( 'db - charTable >> ' + table.getSize() );
			return table;
		} ());
		
		inst.char = charTable;
		inst.charGroup = charGroupTable;
		inst.skill = skillTable;
		
		return inst;
	} ());
	
	inst.actionCards = actionCards;
	
	return inst;
}());
/*******************************************************************************
 *	Event
 */
/*******************************************************************************
 *	UI
 */
var createUI = function () {
	var inst = {};
	
	var createObj = function ( type, className, text ) {
		var obj = document.createElement( type );
		obj.className = className;
		if ( typeof text !== 'undefined' ) {
			obj.innerHTML = text;
		}
		return obj;
	};
	
	(function init() {
		var divWrapper = createObj( 'div', 'wrapper' );
		document.body.appendChild( divWrapper );
	} ());
	
	return inst;
};
/*******************************************************************************
 *	Model
 */

var createFlow = function () {
	var inst = {};
	
	var flowMap = {};
	
	var add = function ( id, proc ) {
		flowMap[id] = proc;
	};
	
	var next = function ( id, code, nextId ) {
	};
	
	inst.add = add;
	inst.next = next;
	
	return inst;
};

var GameStage = {};
GameStage.DEAL = 'DEAL';
GameStage.END = 'END';
GameStage.ERROR = 'ERROR';
GameStage.START = 'START';

var FlowResult = {};
FlowResult.OK = 'OK';
FlowResult.FAIL = 'FAIL';

var flow = (function () {
	var actDeal = function () { log( 'actDeal' ) };
	var actEnd = function () { log( 'actEnd' ) };
	var actError = function () { log( 'actError' ) };
	var actStart = function () { log( 'actStart' ) };
	
	var inst = createFlow();
	inst.add( GameStage.DEAL, actDeal );
	inst.add( GameStage.END, actEnd );
	inst.add( GameStage.ERROR, actError );
	inst.add( GameStage.START, actStart );
	
	inst.next( GameStage.DEAL, FlowResult.FAIL, GameStage.ERROR );
	inst.next( GameStage.END, FlowResult.FAIL, GameStage.ERROR );
	inst.next( GameStage.START, FlowResult.FAIL, GameStage.ERROR );
	
	inst.next( GameStage.START, FlowResult.OK, GameStage.DEAL );
	inst.next( GameStage.DEAL, FlowResult.OK, GameStage.END );
	inst.next( GameStage.END, FlowResult.OK, GameStage.START );
	
	inst.next( GameStage.ERROR, FlowResult.OK, GameStage.END );
	inst.next( GameStage.ERROR, FlowResult.FAIL, GameStage.END );
	
	return inst;
} ())

var createModel = function () {
	var inst = {};
	
	var setNewGame = function ( cardSetId, playerCardsA, playerCardsB ) {
		inst.data = {};
		inst.data.cardSet = {};
		inst.data.cardSet.id = cardSetId;
		inst.data.cardSet.storeList = [];
		inst.data.cardSet.usedInStageList = [];
		inst.data.cardSet.usedInRoundList = [];
		
	//	inst.stage = 
	};
	
	setNewGame( 0, null, null );
	
	inst.setNewGame = setNewGame;
	
	return inst;
};
/*******************************************************************************
 *	Controller
 */
var createCtrl = function () {
	var inst = {};
	
	var model = createModel();
	
	return inst;
};
/*******************************************************************************
 *	Main
 */
var main = (function () {
	log( 'init start' );
	var ui = createUI();
	log( 'init UI ready' );
	var ctrl = createCtrl();
	log( 'init Controller ready' );
	
	log( 'init ready' );
}());
</script>
</html>