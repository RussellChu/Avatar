<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<style>
.abc:hover {
	background-color: #086912;
}
.abc {
	background-attachment: scroll;
	background-clip: border-box;
	background-color: rgb(51, 172, 63);
	background-image: none;
	background-origin: padding-box;
	background-position-x: 0%;
	background-position-y: 0%;
	background-repeat-x: initial;
	background-repeat-y: initial;
	background-size: auto;
	border-bottom-color: rgb(255, 255, 255);
	border-bottom-left-radius: 3px;
	border-bottom-right-radius: 3px;
	border-bottom-style: none;
	border-bottom-width: 0px;
	border-image-outset: 0px;
	border-image-repeat: stretch;
	border-image-slice: 100%;
	border-image-source: none;
	border-image-width: 1;
	border-left-color: rgb(255, 255, 255);
	border-left-style: none;
	border-left-width: 0px;
	border-right-color: rgb(255, 255, 255);
	border-right-style: none;
	border-right-width: 0px;
	border-top-color: rgb(255, 255, 255);
	border-top-left-radius: 3px;
	border-top-right-radius: 3px;
	border-top-style: none;
	border-top-width: 0px;
	box-sizing: border-box;
	color: rgb(255, 255, 255);
	cursor: default;
	display: inline-block;
	font-family: Arial;
	font-size: 15px;
	font-stretch: normal;
	font-style: normal;
	font-variant-caps: normal;
	font-variant-ligatures: normal;
	font-variant-numeric: normal;
	font-weight: normal;
	height: 33px;
	letter-spacing: normal;
	line-height: normal;
	margin-bottom: 0px;
	margin-left: 0px;
	margin-right: 0px;
	margin-top: 0px;
	outline-color: rgb(255, 255, 255);
	outline-style: none;
	outline-width: 0px;
	padding-bottom: 8px;
	padding-left: 20px;
	padding-right: 20px;
	padding-top: 8px;
	text-align: center;
	text-indent: 0px;
	text-rendering: auto;
	text-shadow: none;
	text-transform: none;
	user-select: none;
	white-space: pre;
	width: 87px;
	word-spacing: 0px;
	writing-mode: horizontal-tb;
	-webkit-appearance: none;
	-webkit-rtl-ordering: logical;
	-webkit-border-image: none;
}
</style>
</head>
<body style="margin:0;">
<div id="assets">
<div id="btn">
<input type="button" value="Search A" class="abc"><input type="button" value="Search" id="btnSearch" class="abc">
</div>
</div>
</body>
<!--

-->
<script>

<!-- API -->
var tools = (function () {
	var instance = {};

	var log = function () {
		for(var i = 0; i < arguments.length; i++) {
			console.log( arguments[i] );
		}
	};
	
	var setter = {};
	
	var isValidInt = function ( value ) {
		if ( value !== parseInt( value ) ) {
			return false;
		}
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return false;
		}
		return true;
	};
	
	var isValidNum = function ( value ) {
		if ( typeof value !== 'number' ) {
			return false;
		}
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return false;
		}
		return true;
	};
	
	var isValidObj = function ( value ) {
		if ( typeof value !== 'object' ) {
			return false;
		}
		return ( value !== null );
	};
	
	var isValidFunc = function ( value ) {
		return ( typeof value === 'function' );
	};
	
	var hasValidNum = function ( obj, key ) {
		if ( !isValidObj( obj ) ) {
			return false;
		}
		if ( typeof obj[key] !== 'number' ) {
			return false;
		}
		var value = obj[key];
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return false;
		}
		return true;
	}
	
	var toInt = function ( p_value ) {
		var value = parseInt( p_value );
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return 0;
		}
		return value;
	}
	
	var toNum = function ( p_value ) {
		var value = Number( p_value );
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return 0;
		}
		return value;
	}
	
	var toStr = function ( value ) {
		if ( typeof value === 'string' ) {
			return value;
		}
		if ( typeof value === 'number' ) {
			return String( value );
		}
		if ( typeof value === 'boolean' ) {
			return String( value );
		}
		return '';
	};
	
	var setStr = function ( value, defaultValue ) {
		if ( typeof value === 'string' ) {
			return value;
		}
		if ( typeof value === 'number' ) {
			return String( value );
		}
		if ( typeof value === 'boolean' ) {
			return String( value );
		}
		return toStr( defaultValue );
	};
	
	var setNum = function ( value, defaultValue, option ) {
		var rslt = 0;
		if ( isValidNum( value ) ) {
			rslt = value;
		} else {
			rslt = toNum( defaultValue );
		}
		if ( isValidObj( option ) ) {
			if ( hasValidNum( option, 'min' ) ) {
				var min = option.min;
				if ( rslt < min )
				{
					rslt = min;
				}
			}
			if ( hasValidNum( option, 'max' ) ) {
				var max = option.max;
				if ( rslt > max )
				{
					rslt = max;
				}
			}
		}
		return rslt;
	};
	
	var setInt = function ( value, defaultValue, option ) {
		var rslt = 0;
		if ( isValidInt( value ) ) {
			rslt = value;
		} else {
			rslt = toInt( defaultValue );
		}
		if ( isValidObj( option ) ) {
			if ( hasValidNum( option, 'min' ) ) {
				var min = toInt( option.min );
				if ( rslt < min )
				{
					rslt = min;
				}
			}
			if ( hasValidNum( option, 'max' ) ) {
				var max = toInt( option.max );
				if ( rslt > max )
				{
					rslt = max;
				}
			}
		}
		return rslt;
	};
	
	setter.isValidInt = isValidInt;
	setter.isValidNum = isValidNum;
	setter.isValidObj = isValidObj;
	setter.isValidFunc = isValidFunc;
	setter.hasValidNum = hasValidNum;
	setter.toInt = toInt;
	setter.toNum = toNum;
	setter.toStr = toStr;
	setter.setStr = setStr;
	setter.setNum = setNum;
	setter.setInt = setInt;
	
	// key of Array always string
	var isExist = function ( obj ) {
		if ( typeof obj === 'undefined' ) {
			return false;
		}
		if ( typeof obj === 'number' ) {
			if ( obj === NaN || obj === Infinity || obj === -Infinity ) {
				return false;
			}
			return true;
		}
		if ( typeof obj === 'string' ) {
			if ( obj === '' ) {
				return false;
			}
			return true;
		}
		if ( typeof obj === 'object' ) {
			if ( obj === null ) {
				return false;
			}
			return true;
		}
		return true;
	};
	
	var ifExistDo = function ( obj, key, func, defaultValue ) {
		var result;
		if ( isExist( defaultValue ) ) {
			result = defaultValue;
		} else {
			result = false;
		}
		if ( !isValidObj( obj ) ) {
			return result;
		}
		if ( typeof key === 'undefined' ) {
			return result;
		}
		if ( typeof func !== 'function' ) {
			return result;
		}
		if ( !isExist( obj[key] ) ) {
			return result;
		}
		return func( obj[key] );
	};
	
	var getChildById = function ( inst, id ) {
		if ( !isExist( inst ) ) {
			return null;
		}
		if ( !isExist( id ) ) {
			return null;
		}
		for(var i = 0; i < inst.childNodes.length; i++) {
			var item = inst.childNodes[i];
			if ( item.id === id ) {
				return item;
			}
		}
		return null;
	};
	
	var buildClass = function ( setting ) {
		if ( !isValidObj( setting ) ) {
			return function () {};
		}
		
		var TAG = setStr( setting['TAG'], 'Unknown' );
		
		var superClass;
		if ( typeof setting.superClass === 'function' ) {
			superClass = setting.superClass;
		}
		
		var constructor;
		if ( typeof setting.constructor === 'function' ) {
			constructor = setting.constructor;
		} else {
			constructor = function () {};
		}
		
		var __static__ = setting.__static__;
		
		var hasProp = {}.hasOwnProperty;
		
		var newClass = function () {
			constructor.apply( this, arguments );
		};
		
	//	log( TAG );
	//	Object.defineProperty( newClass.prototype.constructor, 'name', { value: TAG } );
		
		// inherit super class
		if ( typeof superClass === 'function' ) {
			// set static param / method
			for (var key in superClass) {
				if ( hasProp.call( superClass, key )) {
					newClass[key] = superClass[key];
				}
			}
			
			newClass.__super__ = superClass.prototype;
			newClass.prototype = {};
			
			// set dynamic param / method
			for (var key in superClass.prototype) {
			//	if ( hasProp.call( superClass.prototype, key )) {
					newClass.prototype[key] = superClass.prototype[key];
			//	}
			}
		}
		
		delete setting['TAG'];
		delete setting['__static__'];
		delete setting['constructor'];
		delete setting['superClass'];
		delete setting['err'];
		delete setting['log'];
		
		for (var key in setting) {
			newClass.prototype[key] = setting[key];
		}
		
		newClass.prototype.constructor = constructor;
		
		newClass.prototype.err = function () {
			console.log( 'ERROR', TAG, arguments );
		};
		
		newClass.prototype.log = function () {
			console.log( TAG, arguments );
		};
		
		if ( isValidObj( __static__ ) ) {
			for (var key in __static__) {
				newClass[key] = __static__[key];
				/*
				Object.defineProperty( newClass, key, {
					value: constant[key],
					writable: false,
					enumerable: true,
					configurable: true
				});
				*/
			}
		}
		
		return newClass;
	};
	
	instance.buildClass = buildClass;
	instance.ifExistDo = ifExistDo;
	instance.isExist = isExist;
	instance.setter = setter;
	instance.getChildById = getChildById;
	instance.log = log;
	return instance;
} ());

var buildClass = tools.buildClass;
var ifExistDo = tools.ifExistDo;
var isExist = tools.isExist;
var setter = tools.setter;
var getChildById = tools.getChildById;
var log = tools.log;

var TimeCore = (function () {
	var inst = {};
	var currTime = 0;
	var delayList = [{}];
	var timeSlot = {};
	
	var updateCurrTime = function () {
		var d = new Date();
		currTime = d.getTime();
	};
	
	updateCurrTime();
	
	var handler;
	handler = function () {
		var lastTime = currTime;
		updateCurrTime();
		for(var i = lastTime + 1; i <= currTime; i++) {
			var nextSlot = timeSlot[i];
			if ( !setter.isValidObj( nextSlot ) ) {
				continue;
			}
			for(var j = 0; j < nextSlot.length; j++) {
				if ( setter.isValidFunc( nextSlot[j] ) ) {
					nextSlot[j]();
					delete nextSlot[j];
				}
			}
			delete timeSlot[i];
		}
		setTimeout( handler, 1 );
	};
	
	var delay = function ( callBack, p_interval ) {
		if ( !setter.isValidFunc( callBack ) ) {
			return 0;
		}
		
		var interval = setter.setInt( p_interval, 0 );
		
		if ( interval < 1 ) {
			return 0;
		}
		
		var nextTime = Math.floor(currTime + interval);
		var nextSlot = timeSlot[nextTime];
		if ( !setter.isValidObj( nextSlot ) ) {
			nextSlot = [];
			timeSlot[nextTime] = nextSlot;
		}
		
		var delayId = delayList.length;
		delayList.push( {slot: nextTime, idx: nextSlot.length} );
		
		nextSlot.push( callBack );
		
		return delayId;
	};
	
	var killDelay = function ( delayId ) {
		if ( !setter.isValidInt( delayId ) ) {
			return;
		}
		if ( delayId <= 0 ) {
			return;
		}
		if ( setter.isValidObj( delayList[delayId] ) ) {
			var slot = delayList[delayId].slot;
			var idx = delayList[delayId].idx;
			delete delayList[delayId];
			
			var nextSlot = timeSlot[slot];
			if ( setter.isValidObj( nextSlot ) ) {
				nextSlot[idx] = null;
			}
		}
	}
	
	var Timer = buildClass({
		  TAG: 'Timer'
		, _callBack: null
		, _delayId: 0
		, _init: false
		, _minItvl: 0
		, _run: false
		, _stdItvl: 0
		, _t: 0
		, _t0: 0
		, constructor: function ( callBack, p_stdItvl, p_minItvl ) {
			if ( !setter.isValidFunc( callBack ) ) {
				return 0;
			}
			
			var stdItvl = setter.setInt( p_stdItvl, 0 );
			if ( stdItvl < 1 ) {
				return;
			}
			
			this._stdItvl = stdItvl;
			this._minItvl = setter.setInt( p_minItvl, stdItvl * 0.5, { min: 1 } );
			
			this._callBack = callBack;
			this._t = currTime - this._stdItvl;
			this._t0 = this._t;
			this._init = true;
		}
		, dispose: function () {
			this.stop();
			
			this._init = false;
			
			this._callBack = null;
		}
		, process: function () {
			if ( !this._run ) {
				return;
			}
			
			var t2 = this._t;
			this._t = currTime;
			var diff2 = this._t - this._t0;
			this._t0 = this._t;
			var diff = this._stdItvl + t2 - this._t;
			if ( diff < this._minItvl - this._stdItvl ) {
				diff = this._minItvl - this._stdItvl;
			}
			
			this._t += diff;
			
			if ( this._callBack.length === 1 ) {
				this._callBack( diff2 );
			}
			else {
				this._callBack();
			}
			
			var self = this;
			var selfArgs = arguments;
			this._delayId = delay( function () {
				self.process.apply( self, selfArgs );
			}, diff + this._stdItvl );
		}
		, run: function () {
			if ( !this._init ) {
				return;
			}
			
			if ( this._run ) {
				return;
			}
			
			this._run = true;
			
			var self = this;
			var selfArgs = arguments;
			this._delayId = delay( function () {
				self.process.apply( self, selfArgs );
			}, 1 );
		}
		, stop: function () {
			this._run = false;
			
			killDelay( this._delayId );
			this._delayId = 0;
		}
		, running: function () {
			return this._run;
		}
	});
	
	var timer = function ( callBack, stdItvl, minItvl ) {
		var inst = new Timer( callBack, stdItvl, minItvl );
		return inst;
	};
	
	inst.delay = delay;
	inst.timer = timer;
	inst.time = function () {
		return currTime;
	}
	
	setTimeout( handler, 1 );
	
	return inst;
} ());

var Signal = buildClass({
	  TAG: 'Signal'
	, _list: null
	, constructor: function () {
		this.init();
	}
	, init: function () {
		this._list = [];
	}
	, dispose: function () {
		this._list = null;
	}
	, add: function ( func ) {
		if ( !setter.isValidFunc( func ) ) {
			return;
		}
		this._list.push( func );
	}
	, dispatch: function ( data ) {
		for(var i = 0; i < this._list.length; i++) {
			this._list[i]( data );
		}
	}
});

var DisplayObject = buildClass({
	  TAG: 'DisplayObject'
	, _inst: null
	, _type: ''
	, _posX: 0
	, _posY: 0
	, constructor: function ( type ) {
		this._type = type;
		this.init();
	}
	, init: function () {
		this._inst = document.createElement( this._type );
		this._inst.style.position = "absolute";
		this._inst.style.left = 0;
		this._inst.style.top = 0;
		this._inst.style.transformOrigin = "0 0";
	}
	, dispose: function () {
		this._inst = null;
	}
	, getInst: function () {
		return this._inst;
	}
	, getPosX: function () {
		return this._posX;
	}
	, getPosY: function () {
		return this._posY;
	}
	, setPosX: function ( x ) {
		this._posX = setter.setInt( x, this._posX );
		this._inst.style.left = this._posX;
	}
	, setPosY: function ( y ) {
		this._posY = setter.setInt( y, this._posY );
		this._inst.style.top = this._posY;
	}
});

var Quad = buildClass({
	  TAG: 'Quad'
	, superClass: DisplayObject
	, _width: 0
	, _height: 0
	, _color: ''
	, _alpha: 0
	, constructor: function ( width, height, color, alpha ) {
		this._width = setter.setInt( width, 0, { min: 0 } );
		this._height = setter.setInt( height, 0, { min: 0 } );
		this._color = setter.setStr( color );
		this._alpha = setter.setNum( alpha, 1, { min: 0, max: 1 } );
		Quad.__super__.constructor.apply( this, ['div'] );
	}
	, init: function () {
		Quad.__super__.init.apply( this, arguments );
		this._inst.style.width = this._width;
		this._inst.style.height = this._height;
		this._inst.style.backgroundColor = this._color;
	}
	, dispose: function () {
		Quad.__super__.dispose.apply( this, arguments );
	}
});

var globalSignal = (function () {
	var instance = {};
	
	var mouseMove = new Signal();
	var mouseUp = new Signal();
	
	document.body.onmousemove = function ( e ) {
		mouseMove.dispatch( e );
	};
	
	document.body.onmouseup = function ( e ) {
		mouseUp.dispatch( e );
	};
	
	instance.mouseMove = mouseMove;
	instance.mouseUp = mouseUp;
	
	return instance;
} ());

var dragManager = (function () {
	var instance = {};
	
	var dragTarget = null;
	var dragX = 0;
	var dragY = 0;
	
	globalSignal.mouseMove.add( function ( e ) {
		/*
		if ( e.buttons === 0 ) {
			dragTarget = null;
		}
		*/
		
		if ( dragTarget === null ) {
			return;
		}
		
		dragTarget.setPosX( e.pageX - dragX );
		dragTarget.setPosY( e.pageY - dragY );
	});
	
	globalSignal.mouseUp.add( function ( e ) {
		dragTarget = null;
	});
	
	var enableDrag = function ( target ) {
		if ( !setter.isValidObj( target ) ) {
			return;
		}
		
		target.getInst().style.userSelect = 'none';
		
		target.getInst().onmousedown = function ( e ) {
			dragTarget = target;
			dragX = e.pageX - target.getPosX();
			dragY = e.pageY - target.getPosY();
		};
	};
	
	var disableDrag = function ( target ) {
		if ( !setter.isValidObj( target ) ) {
			return;
		}
		if ( dragTarget === target ) {
			dragTarget = null;
		}
		target.getInst().onmousedown = null;
	};
	
	instance.enableDrag = enableDrag;
	instance.disableDrag = disableDrag;
	
	return instance;
} ());

var BaseObject = buildClass({
	  TAG: 'BaseObject'
	, _inst: null
	, constructor: function ( inst ) {
		if ( !setter.isValidObj( inst ) ) {
			this.err( 'No inst' );
			return;
		}
		this._inst = inst;
		this.init();
	}
	, init: function () {
		;
	}
	, dispose: function () {
		this._inst = null;
	}
	, getInst: function () {
		return this._inst;
	}
});

var Vec2 = buildClass({
	  TAG: 'Vec2'
	, x: 0
	, y: 0
	, __static__: {
		isValid: function ( value ) {
			if ( !setter.isValidObj( inst ) ) {
				return false;
			}
			if ( !setter.isValidNum( value.x ) ) {
				return false;
			}
			if ( !setter.isValidNum( value.y ) ) {
				return false;
			}
			return true;
		}
	}
	, constructor: function ( x, y ) {
		this.x = setter.setNum( x, 0 );
		this.y = setter.setNum( y, 0 );
	}
});

var Vec3 = buildClass({
	  TAG: 'Vec3'
	, x: 0
	, y: 0
	, z: 0
	, __static__: {
		isValid: function ( value ) {
			if ( !setter.isValidObj( inst ) ) {
				return false;
			}
			if ( !setter.isValidNum( value.x ) ) {
				return false;
			}
			if ( !setter.isValidNum( value.y ) ) {
				return false;
			}
			if ( !setter.isValidNum( value.z ) ) {
				return false;
			}
			return true;
		}
	}
	, constructor: function ( x, y, z ) {
		this.x = setter.setNum( x, 0 );
		this.y = setter.setNum( y, 0 );
		this.z = setter.setNum( z, 0 );
	}
});

var a2 = new Vec2();
var a3 = new Vec3();

log( a2 instanceof Vec2 );
log( a2 instanceof Vec3 );
log( a3 instanceof Vec2 );
log( a3 instanceof Vec3 );
log( a2 );
log( a3 );

var GravityWorld = buildClass({
	  TAG: 'GravityWorld'
	, _x: 0
	, _y: 0
	, _w: 0
	, _h: 0
	, _maxSpeed: 0
	, _child: null
	, _timer: null
	, constructor: function () {
		this.init();
	}
	, init: function () {
		var self = this;
		
		this._child = [];
		
		this._timer = TimeCore.timer( function ( diff ) {
			self.run( diff );
		}, 1 );
		this._timer.run();
	}
	, dispose: function () {
		this._child = null;
		if ( this._timer !== null ) {
			this._timer.dispose();
			this._timer = null;
		}
	}
	, setMaxSpeed: function ( value ) {
		this._maxSpeed = setter.setNum( value, 0, { min: 0 } );
	}
	, setRect: function ( x, y, w, h ) {
		this._x = setter.setInt( x, 0, { min: 0 } );
		this._y = setter.setInt( y, 0, { min: 0 } );
		this._w = setter.setInt( w, 0, { min: 0 } );
		this._h = setter.setInt( h, 0, { min: 0 } );
	}
	, add: function ( x, y, radius, mass, p_velocity ) {
		if ( this._child === null ) {
			return -1;
		}
		
		var id = this._child.length;
		
		// to do, check p_velocity
		
		this._child.push({
			x: setter.setNum( x, 0 ),
			y: setter.setNum( y, 0 ),
			radius: setter.setNum( radius, 0, { min: 0 } ),
			mass: setter.setNum( mass, 0, { min: 0 } ),
			velocity: p_velocity
		});
		return id;
	}
	, run: function ( diff ) {
		
	}
});

var ProjctA = buildClass({
	  TAG: 'ProjctA'
	, _inst: null
	, _parent: null
	, constructor: function ( parent ) {
		if ( !setter.isValidObj( parent ) ) {
			this.err( 'No parent' );
			return;
		}
		this._parent = parent;
		this.init();
	}
	, init: function () {
		this._inst = new Quad( 0, 0, '#000000' );
		this._parent.appendChild( this._inst.getInst() );
		/*
		var quad = new Quad( 100, 100, '#ff0000' );
		quad.setPosX( 50 );
		quad.setPosY( 50 );
		this._inst.getInst().appendChild( quad.getInst() );
		//document.body.appendChild( quad.getInst() );
		dragManager.enableDrag( quad );

		var quad2 = new Quad( 100, 100, '#ffff00' );
		quad2.setPosX( 150 );
		quad2.setPosY( 150 );
		this._inst.getInst().appendChild( quad2.getInst() );
		dragManager.enableDrag( quad2 );

		var angle = 0;
		var speed = 0.0005;

		var t = TimeCore.timer( function ( diff ) {
		//	log( diff );
			angle += ( speed ) % 1;
			var s = Math.sin( angle * Math.PI * 2 );
			var c = Math.cos( angle * Math.PI * 2 );
			sp.getInst().style.transform = "matrix(" + c + "," + s + "," + (-s) + "," + c + ",0,0)";
		}, 1 );
		// t.run();
		*/
		var world = new GravityWorld();
		world.setRect( 0, 0, 1000, 500 );
		world.add(  );
	}
	, dispose: function () {
		this._inst = null;
		this._parent = null;
	}
});

new ProjctA( document.body );

<!-- Notices -->
/*
to do -
	find children by name?
*/

<!-- Testing Area -->


/*
var num = 0;
var t = TimeCore.timer( function ( diff ) {
	num++;
	if ( num > 200 )
	{
		t.stop();
	}
	console.log( TimeCore.time() + " - " + diff + " " + num );
}, 50 );
t.run();
*/

/*
var aniObj = {};
aniObj['testObj'] = 0;

log( "Testing A" );

tools.ifExistDo( aniObj, 'testObj', function ( obj ) {
	log( "Testing B" );
});

var mainView = document.createElement( 'div' );
document.body.appendChild( mainView );
var assets = getChildById( document.body, 'assets' );
var btn = getChildById( assets, 'btn' );
var newBtn = btn.cloneNode(true);
newBtn.id = 'aaa';
mainView.appendChild( newBtn );
*/
</script>
</html>