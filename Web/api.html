<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<style>
.abc:hover {
	background-color: #086912;
}
.abc {
	background-attachment: scroll;
	background-clip: border-box;
	background-color: rgb(51, 172, 63);
	background-image: none;
	background-origin: padding-box;
	background-position-x: 0%;
	background-position-y: 0%;
	background-repeat-x: initial;
	background-repeat-y: initial;
	background-size: auto;
	border-bottom-color: rgb(255, 255, 255);
	border-bottom-left-radius: 3px;
	border-bottom-right-radius: 3px;
	border-bottom-style: none;
	border-bottom-width: 0px;
	border-image-outset: 0px;
	border-image-repeat: stretch;
	border-image-slice: 100%;
	border-image-source: none;
	border-image-width: 1;
	border-left-color: rgb(255, 255, 255);
	border-left-style: none;
	border-left-width: 0px;
	border-right-color: rgb(255, 255, 255);
	border-right-style: none;
	border-right-width: 0px;
	border-top-color: rgb(255, 255, 255);
	border-top-left-radius: 3px;
	border-top-right-radius: 3px;
	border-top-style: none;
	border-top-width: 0px;
	box-sizing: border-box;
	color: rgb(255, 255, 255);
	cursor: default;
	display: inline-block;
	font-family: Arial;
	font-size: 15px;
	font-stretch: normal;
	font-style: normal;
	font-variant-caps: normal;
	font-variant-ligatures: normal;
	font-variant-numeric: normal;
	font-weight: normal;
	height: 33px;
	letter-spacing: normal;
	line-height: normal;
	margin-bottom: 0px;
	margin-left: 0px;
	margin-right: 0px;
	margin-top: 0px;
	outline-color: rgb(255, 255, 255);
	outline-style: none;
	outline-width: 0px;
	padding-bottom: 8px;
	padding-left: 20px;
	padding-right: 20px;
	padding-top: 8px;
	text-align: center;
	text-indent: 0px;
	text-rendering: auto;
	text-shadow: none;
	text-transform: none;
	user-select: none;
	white-space: pre;
	width: 87px;
	word-spacing: 0px;
	writing-mode: horizontal-tb;
	-webkit-appearance: none;
	-webkit-rtl-ordering: logical;
	-webkit-border-image: none;
}
</style>
</head>
<body style="margin:0;">
<div id="assets">
<div id="btn">
<input type="button" value="Search A" class="abc"><input type="button" value="Search" id="btnSearch" class="abc">
</div>
</div>
</body>
<!--

-->
<script src="./lib/core.js"></script>
<script>


////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////
////////////////////
//	API
////////////////////
////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////

var tools = (function () {
	var instance = {};
	
	var log = function () {
		var str = "";
		for(var i = 0; i < arguments.length; i++) {
			if ( i > 0 ) {
				str += " ";
			}
			str += arguments[i];
		}
		console.log( str );
	};
	
	var setter = {};
	
	var isValidInt = function ( value ) {
		if ( value !== parseInt( value ) ) {
			return false;
		}
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return false;
		}
		return true;
	};
	
	var isValidNum = function ( value ) {
		if ( typeof value !== 'number' ) {
			return false;
		}
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return false;
		}
		return true;
	};
	
	var isValidObj = function ( value ) {
		if ( typeof value !== 'object' ) {
			return false;
		}
		return ( value !== null );
	};
	
	var isValidFunc = function ( value ) {
		return ( typeof value === 'function' );
	};
	
	var hasValidNum = function ( obj, key ) {
		if ( !isValidObj( obj ) ) {
			return false;
		}
		if ( typeof obj[key] !== 'number' ) {
			return false;
		}
		var value = obj[key];
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return false;
		}
		return true;
	};
	
	var hasValidStr = function ( obj, key ) {
		if ( !isValidObj( obj ) ) {
			return false;
		}
		if ( typeof obj[key] !== 'string' ) {
			return false;
		}
		return true;
	};
	
	var toInt = function ( p_value ) {
		var value = parseInt( p_value );
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return 0;
		}
		return value;
	};
	
	var toNum = function ( p_value ) {
		var value = Number( p_value );
		if ( value === NaN || value === Infinity || value === -Infinity ) {
			return 0;
		}
		return value;
	};
	
	var toStr = function ( value ) {
		if ( typeof value === 'string' ) {
			return value;
		}
		if ( typeof value === 'number' ) {
			return String( value );
		}
		if ( typeof value === 'boolean' ) {
			return String( value );
		}
		return '';
	};
	
	var setBool = function ( value, defaultValue ) {
		if ( typeof value === 'boolean' ) {
			return value;
		}
		if ( typeof defaultValue === 'boolean' ) {
			return defaultValue;
		}
		return false;
	};
	
	var setStr = function ( value, defaultValue ) {
		if ( typeof value === 'string' ) {
			return value;
		}
		if ( typeof value === 'number' ) {
			return String( value );
		}
		if ( typeof value === 'boolean' ) {
			return String( value );
		}
		return toStr( defaultValue );
	};
	
	var setNum = function ( value, defaultValue, option ) {
		var rslt = 0;
		if ( isValidNum( value ) ) {
			rslt = value;
		} else {
			rslt = toNum( defaultValue );
		}
		if ( isValidObj( option ) ) {
			if ( hasValidNum( option, 'min' ) ) {
				var min = option.min;
				if ( rslt < min )
				{
					rslt = min;
				}
			}
			if ( hasValidNum( option, 'max' ) ) {
				var max = option.max;
				if ( rslt > max )
				{
					rslt = max;
				}
			}
		}
		return rslt;
	};
	
	var setInt = function ( value, defaultValue, option ) {
		var rslt = 0;
		if ( isValidNum( value ) ) {
			rslt = toInt( value );
		} else {
			rslt = toInt( defaultValue );
		}
		if ( isValidObj( option ) ) {
			if ( hasValidNum( option, 'min' ) ) {
				var min = toInt( option.min );
				if ( rslt < min )
				{
					rslt = min;
				}
			}
			if ( hasValidNum( option, 'max' ) ) {
				var max = toInt( option.max );
				if ( rslt > max )
				{
					rslt = max;
				}
			}
		}
		return rslt;
	};
	
	setter.isValidInt = isValidInt;
	setter.isValidNum = isValidNum;
	setter.isValidObj = isValidObj;
	setter.isValidFunc = isValidFunc;
	setter.hasValidNum = hasValidNum;
	setter.hasValidStr = hasValidStr;
	setter.toInt = toInt;
	setter.toNum = toNum;
	setter.toStr = toStr;
	setter.setBool = setBool;
	setter.setStr = setStr;
	setter.setNum = setNum;
	setter.setInt = setInt;
	
	// key of Array always string
	var isExist = function ( obj ) {
		if ( typeof obj === 'undefined' ) {
			return false;
		}
		if ( typeof obj === 'number' ) {
			if ( obj === NaN || obj === Infinity || obj === -Infinity ) {
				return false;
			}
			return true;
		}
		if ( typeof obj === 'string' ) {
			if ( obj === '' ) {
				return false;
			}
			return true;
		}
		if ( typeof obj === 'object' ) {
			if ( obj === null ) {
				return false;
			}
			return true;
		}
		return true;
	};
	
	var ifExistDo = function ( obj, key, func, defaultValue ) {
		var result;
		if ( isExist( defaultValue ) ) {
			result = defaultValue;
		} else {
			result = false;
		}
		if ( !isValidObj( obj ) ) {
			return result;
		}
		if ( typeof key === 'undefined' ) {
			return result;
		}
		if ( typeof func !== 'function' ) {
			return result;
		}
		if ( !isExist( obj[key] ) ) {
			return result;
		}
		return func( obj[key] );
	};
	
	var getChildById = function ( inst, id ) {
		if ( !isExist( inst ) ) {
			return null;
		}
		if ( !isExist( id ) ) {
			return null;
		}
		for(var i = 0; i < inst.childNodes.length; i++) {
			var item = inst.childNodes[i];
			if ( item.id === id ) {
				return item;
			}
		}
		return null;
	};
	
	var buildClass = function ( setting ) {
		if ( !isValidObj( setting ) ) {
			return function () {};
		}
		
		var TAG = setStr( setting['TAG'], 'Unknown' );
		
		var superClass;
		if ( typeof setting.superClass === 'function' ) {
			superClass = setting.superClass;
		}
		
		var constructor;
		if ( typeof setting.constructor === 'function' ) {
			constructor = setting.constructor;
		} else {
			constructor = function () {};
		}
		
		var __static__ = setting.__static__;
		
		var hasProp = {}.hasOwnProperty;
		
		var newClass;
		
		eval( "newClass = function " + TAG + "() { constructor.apply( this, arguments ); };" );
		
		newClass.__tag__ = TAG;
		newClass.__tags__ = {};
		newClass.__tags__[TAG] = true;
		
		// inherit super class
		if ( typeof superClass === 'function' ) {
			// set static param / method
			for (var key in superClass) {
				if ( key === '__tag__' ) {
					continue;
				}
				if ( key === '__tags__' ) {
					continue;
				}
				if ( hasProp.call( superClass, key )) {
					newClass[key] = superClass[key];
				}
			}
			
			for (var key in superClass.__tags__) {
				newClass.__tags__[key] = true;
			}
			
			newClass.__super__ = superClass.prototype;
			newClass.prototype = {};
			
			// set dynamic param / method
			for (var key in superClass.prototype) {
			//	if ( hasProp.call( superClass.prototype, key )) {
					newClass.prototype[key] = superClass.prototype[key];
			//	}
			}
		}
		
		delete setting['TAG'];
		delete setting['__static__'];
		delete setting['constructor'];
		delete setting['superClass'];
		delete setting['err'];
		delete setting['log'];
		delete setting['getTag'];
		delete setting['hasTagOfClass'];
		
		for (var key in setting) {
			newClass.prototype[key] = setting[key];
		}
		
		newClass.prototype.constructor = constructor;
		
		newClass.prototype.err = function () {
			var str = "";
			for(var i = 0; i < arguments.length; i++) {
				if ( i > 0 ) {
					str += " ";
				}
				str += arguments[i];
			}
			log( '[ERROR]', '[' + TAG + ']', str );
		};
		
		newClass.prototype.log = function () {
			var str = "";
			for(var i = 0; i < arguments.length; i++) {
				if ( i > 0 ) {
					str += " ";
				}
				str += arguments[i];
			}
			log( '[LOG]', '[' + TAG + ']', str );
		};
		
		newClass.prototype.getTag = function () {
			return newClass.__tag__;
		};
		
		newClass.prototype.hasTagOfClass = function ( value ) {
			if ( !( typeof value === 'function' ) ) {
				return false;
			}
			if ( !( typeof value.__tag__ === 'string' ) ) {
				return false;
			}
			
			var tag = value.__tag__;
			for (var key in newClass.__tags__) {
				if ( key === tag ) {
					return true;
				}
			}
			
			return false;
		};
		
		if ( isValidObj( __static__ ) ) {
			for (var key in __static__) {
				newClass[key] = __static__[key];
				/*
				Object.defineProperty( newClass, key, {
					value: constant[key],
					writable: false,
					enumerable: true,
					configurable: true
				});
				*/
			}
		}
		
		return newClass;
	};
	
	var looper = {};
	
	looper.pairs = function ( list, func ) {
		if ( !( list instanceof Array ) ) {
			return;
		}
		if ( list === null ) {
			return;
		}
		if ( !setter.isValidFunc( func ) ) {
			return;
		}
		for(var i = 0; i < list.length - 1; i++) {
			if ( !setter.isValidObj( list[i] ) ) {
				continue;
			}
			for(var j = i + 1; j < list.length; j++) {
				if ( !setter.isValidObj( list[j] ) ) {
					continue;
				}
				func( list[i], list[j] );
			}
		}
	};
	
	instance.buildClass = buildClass;
	instance.ifExistDo = ifExistDo;
	instance.isExist = isExist;
	instance.looper = looper;
	instance.setter = setter;
	instance.getChildById = getChildById;
	instance.log = log;
	return instance;
} ());

var buildClass = tools.buildClass;
var ifExistDo = tools.ifExistDo;
var isExist = tools.isExist;
var looper = tools.looper;
var setter = tools.setter;
var getChildById = tools.getChildById;
var log = tools.log;

var TimeCore = (function () {
	var inst = {};
	var currTime = 0;
	var delayList = [{}];
	var timeSlot = {};
	
	var updateCurrTime = function () {
		var d = new Date();
		currTime = d.getTime();
	};
	
	updateCurrTime();
	
	var handler;
	handler = function () {
		var lastTime = currTime;
		updateCurrTime();
		for(var i = lastTime + 1; i <= currTime; i++) {
			var nextSlot = timeSlot[i];
			if ( !setter.isValidObj( nextSlot ) ) {
				continue;
			}
			for(var j = 0; j < nextSlot.length; j++) {
				if ( setter.isValidFunc( nextSlot[j] ) ) {
					nextSlot[j]();
					delete nextSlot[j];
				}
			}
			delete timeSlot[i];
		}
		setTimeout( handler, 1 );
	};
	
	var delay = function ( callBack, p_interval ) {
		if ( !setter.isValidFunc( callBack ) ) {
			return 0;
		}
		
		var interval = setter.setInt( p_interval, 0 );
		
		if ( interval < 1 ) {
			return 0;
		}
		
		var nextTime = Math.floor(currTime + interval);
		var nextSlot = timeSlot[nextTime];
		if ( !setter.isValidObj( nextSlot ) ) {
			nextSlot = [];
			timeSlot[nextTime] = nextSlot;
		}
		
		var delayId = delayList.length;
		delayList.push( {slot: nextTime, idx: nextSlot.length} );
		
		nextSlot.push( callBack );
		
		return delayId;
	};
	
	var killDelay = function ( delayId ) {
		if ( !setter.isValidInt( delayId ) ) {
			return;
		}
		if ( delayId <= 0 ) {
			return;
		}
		if ( setter.isValidObj( delayList[delayId] ) ) {
			var slot = delayList[delayId].slot;
			var idx = delayList[delayId].idx;
			delete delayList[delayId];
			
			var nextSlot = timeSlot[slot];
			if ( setter.isValidObj( nextSlot ) ) {
				nextSlot[idx] = null;
			}
		}
	}
	
	var Timer = buildClass({
		  TAG: 'Timer'
		, _callBack: null
		, _delayId: 0
		, _init: false
		, _minItvl: 0
		, _run: false
		, _stdItvl: 0
		, _t: 0
		, _t0: 0
		, constructor: function ( callBack, p_stdItvl, p_minItvl ) {
			if ( !setter.isValidFunc( callBack ) ) {
				return 0;
			}
			
			var stdItvl = setter.setInt( p_stdItvl, 0 );
			if ( stdItvl < 1 ) {
				return;
			}
			
			this._stdItvl = stdItvl;
			this._minItvl = setter.setInt( p_minItvl, stdItvl * 0.5, { min: 1 } );
			
			this._callBack = callBack;
			this._t = currTime - this._stdItvl;
			this._t0 = this._t;
			this._init = true;
		}
		, dispose: function () {
			this.stop();
			
			this._init = false;
			
			this._callBack = null;
		}
		, process: function () {
			if ( !this._run ) {
				return;
			}
			
			var t2 = this._t;
			this._t = currTime;
			var diff2 = this._t - this._t0;
			this._t0 = this._t;
			var diff = this._stdItvl + t2 - this._t;
			if ( diff < this._minItvl - this._stdItvl ) {
				diff = this._minItvl - this._stdItvl;
			}
			
			this._t += diff;
			
			if ( this._callBack.length === 1 ) {
				this._callBack( diff2 );
			}
			else {
				this._callBack();
			}
			
			var self = this;
			var selfArgs = arguments;
			this._delayId = delay( function () {
				self.process.apply( self, selfArgs );
			}, diff + this._stdItvl );
		}
		, run: function () {
			if ( !this._init ) {
				return;
			}
			
			if ( this._run ) {
				return;
			}
			
			this._run = true;
			
			var self = this;
			var selfArgs = arguments;
			this._delayId = delay( function () {
				self.process.apply( self, selfArgs );
			}, 1 );
		}
		, stop: function () {
			this._run = false;
			
			killDelay( this._delayId );
			this._delayId = 0;
		}
		, running: function () {
			return this._run;
		}
	});
	
	var timer = function ( callBack, stdItvl, minItvl ) {
		var inst = new Timer( callBack, stdItvl, minItvl );
		return inst;
	};
	
	inst.delay = delay;
	inst.timer = timer;
	inst.time = function () {
		return currTime;
	}
	
	setTimeout( handler, 1 );
	
	return inst;
} ());

var Signal = buildClass({
	  TAG: 'Signal'
	, _list: null
	, constructor: function () {
		this.init();
	}
	, init: function () {
		this._list = [];
	}
	, dispose: function () {
		this._list = null;
	}
	, add: function ( func ) {
		if ( !setter.isValidFunc( func ) ) {
			return;
		}
		this._list.push( func );
	}
	, dispatch: function ( data ) {
		for(var i = 0; i < this._list.length; i++) {
			this._list[i]( data );
		}
	}
});

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////
////////////////////
//	CMath
////////////////////
////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////

var CMath = (function () {
	var inst = {};
	
	var Vec2 = buildClass({
		  TAG: 'Vec2'
		, x: 0
		, y: 0
		, __static__: {
			  createFromObj: function ( value ) {
				var rslt = new Vec2();
				if ( !setter.isValidObj( value ) ) {
					return rslt;
				}
				rslt.x = setter.setNum( value.x, 0 );
				rslt.y = setter.setNum( value.y, 0 );
				return rslt;
			}
		}
		, constructor: function ( x, y ) {
			this.x = setter.setNum( x, 0 );
			this.y = setter.setNum( y, 0 );
		}
		, clone: function () {
			return new Vec2( this.x, this.y );
		}
		, convertToObj: function () {
			return { x: this.x, y: this.y };
		}
		, addEql: function ( value ) {
			if ( value.hasTagOfClass( Vec2 ) ) {
				this.x += value.x;
				this.y += value.y;
			} else {
				this.err( 'addEql fail' );
			}
			return this;
		}
		, minusEql: function ( value ) {
			if ( value.hasTagOfClass( Vec2 ) ) {
				this.x -= value.x;
				this.y -= value.y;
			} else {
				this.err( 'minus fail' );
			}
			return this;
		}
		, mulEql: function ( value ) {
			if ( setter.isValidNum( value ) ) {
				this.x *= value;
				this.y *= value;
			} else {
				this.err( 'mulEql fail' );
			}
			return this;
		}
		, divEql: function ( value ) {
			if ( setter.isValidNum( value ) && value !== 0 ) {
				var inv = 1 / value;
				this.x *= inv;
				this.y *= inv;
			} else {
				this.err( 'divEql fail' );
			}
			return this;
		}
		, add: function ( value ) {
			var rslt = this.clone();
			if ( value.hasTagOfClass( Vec2 ) ) {
				rslt.x += value.x;
				rslt.y += value.y;
			} else {
				this.err( 'add fail' );
			}
			return rslt;
		}
		, minus: function ( value ) {
			var rslt = this.clone();
			if ( value.hasTagOfClass( Vec2 ) ) {
				rslt.x -= value.x;
				rslt.y -= value.y;
			} else {
				this.err( 'minus fail' );
			}
			return rslt;
		}
		, mul: function ( value ) {
			var rslt = this.clone();
			if ( setter.isValidNum( value ) ) {
				rslt.x *= value;
				rslt.y *= value;
			} else {
				this.err( 'mul fail' );
			}
			return rslt;
		}
		, div: function ( value ) {
			var rslt = this.clone();
			if ( setter.isValidNum( value ) && value !== 0 ) {
				var inv = 1 / value;
				rslt.x *= inv;
				rslt.y *= inv;
			} else {
				this.err( 'div fail' );
			}
			return rslt;
		}
		, magSqr: function () {
			return this.x * this.x + this.y * this.y;
		}
		, mag: function () {
			return Math.sqrt( this.magSqr() );
		}
		, normalize: function () {
			if ( this.x !== 0 || this.y !== 0 ) {
				var magInv = 1 / this.mag();
				return this.mulEql( magInv );
			}
			return this;
		}
		, dot: function ( value ) {
			return this.x * value.x + this.y * value.y;
		}
	});

	var Vec3 = buildClass({
		  TAG: 'Vec3'
		, x: 0
		, y: 0
		, z: 0
		, __static__: {
			  createFromObj: function ( value ) {
				var rslt = new Vec3();
				if ( !setter.isValidObj( value ) ) {
					return rslt;
				}
				rslt.x = setter.setNum( value.x, 0 );
				rslt.y = setter.setNum( value.y, 0 );
				rslt.z = setter.setNum( value.z, 0 );
				return rslt;
			}
		}
		, constructor: function ( x, y, z ) {
			this.x = setter.setNum( x, 0 );
			this.y = setter.setNum( y, 0 );
			this.z = setter.setNum( z, 0 );
		}
		, clone: function () {
			return new Vec3( this.x, this.y, this.z );
		}
		, convertToObj: function () {
			return { x: this.x, y: this.y, z: this.z };
		}
		, addEql: function ( value ) {
			if ( value.hasTagOfClass( Vec3 ) ) {
				this.x += value.x;
				this.y += value.y;
				this.z += value.z;
			} else {
				this.err( 'addEql fail' );
			}
			return this;
		}
		, minusEql: function ( value ) {
			if ( value.hasTagOfClass( Vec3 ) ) {
				this.x -= value.x;
				this.y -= value.y;
				this.z -= value.z;
			} else {
				this.err( 'minus fail' );
			}
			return this;
		}
		, mulEql: function ( value ) {
			if ( setter.isValidNum( value ) ) {
				this.x *= value;
				this.y *= value;
				this.z *= value;
			} else {
				this.err( 'mulEql fail' );
			}
			return this;
		}
		, divEql: function ( value ) {
			if ( setter.isValidNum( value ) && value !== 0 ) {
				var inv = 1 / value;
				this.x *= inv;
				this.y *= inv;
				this.z *= inv;
			} else {
				this.err( 'divEql fail' );
			}
			return this;
		}
		, add: function ( value ) {
			var rslt = this.clone();
			if ( value.hasTagOfClass( Vec3 ) ) {
				rslt.x += value.x;
				rslt.y += value.y;
				rslt.z += value.z;
			} else {
				this.err( 'add fail' );
			}
			return rslt;
		}
		, minus: function ( value ) {
			var rslt = this.clone();
			if ( value.hasTagOfClass( Vec3 ) ) {
				rslt.x -= value.x;
				rslt.y -= value.y;
				rslt.z -= value.z;
			} else {
				this.err( 'minus fail' );
			}
			return rslt;
		}
		, mul: function ( value ) {
			var rslt = this.clone();
			if ( setter.isValidNum( value ) ) {
				rslt.x *= value;
				rslt.y *= value;
				rslt.z *= value;
			} else {
				this.err( 'mul fail' );
			}
			return rslt;
		}
		, div: function ( value ) {
			var rslt = this.clone();
			if ( setter.isValidNum( value ) && value !== 0 ) {
				var inv = 1 / value;
				rslt.x *= inv;
				rslt.y *= inv;
				rslt.z *= inv;
			} else {
				this.err( 'div fail' );
			}
			return rslt;
		}
		, magSqr: function () {
			return this.x * this.x + this.y * this.y + this.z * this.z;
		}
		, mag: function () {
			return Math.sqrt( this.magSqr() );
		}
		, normalize: function () {
			if ( this.x !== 0 || this.y !== 0 || this.z !== 0 ) {
				var magInv = 1 / this.mag();
				return this.mulEql( magInv );
			}
			return this;
		}
	});
	
	inst.Vec2 = Vec2;
	inst.Vec3 = Vec3;
	
	return inst;
} ());
var Vec2 = CMath.Vec2;
var Vec3 = CMath.Vec3;

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////
////////////////////
//	Model
////////////////////
////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////

var Plane2D = buildClass({
	  TAG: 'Plane2D'
	, _pos: null
	, constructor: function () {
		this.init();
	}
	, init: function () {
		this._pos = new Vec2();
	}
	, dispose: function () {
		this._pos = null;
	}
	, getPos: function () {
		return this._pos.clone();
	}
	, isOverlap: function ( target ) {
		return Plane2DOverlapChecker.calc( this, target );
	}
});

var Plane2D_Cirle = buildClass({
	  TAG: 'Plane2D_Cirle'
	, _radius: 0
	, constructor: function ( radius ) {
		this._radius = setter.setNum( radius, 0, { min: 0 } );
		this.init();
	}
	, init: function () {
		Quad.__super__.init.apply( this, arguments );
		//
	}
	, dispose: function () {
		//
		Quad.__super__.init.apply( this, dispose );
	}
});

var Plane2D_Rect = buildClass({
	  TAG: 'Plane2D_Rect'
	, _cornerX: 0
	, _cornerY: 0
	, _width: 0
	, _height: 0
	, constructor: function ( width, height, cornerX, cornerY ) {
		this._cornerX = setter.setNum( cornerX, 0 );
		this._cornerY = setter.setNum( cornerY, 0 );
		this._width = setter.setNum( width, 0, { min: 0 } );
		this._height = setter.setNum( height, 0, { min: 0 } );
		this.init();
	}
	, init: function () {
		Quad.__super__.init.apply( this, arguments );
		//
	}
	, dispose: function () {
		//
		Quad.__super__.init.apply( this, dispose );
	}
});

Plane2DOverlapChecker = (function () {
	var inst = {};
	
	var calcPointVsCircle = function ( objPt, objCir ) {
		if ( objPt._pos.minus( objCir._pos ).mag() < objCir._radius ) {
			return true;
		}
		return false;
	};
	var calcPointVsRect = function ( objPt, objRec ) {
		if ( objPt._pos.x < objRec._pos.x + objRec._cornerX ) {
			return false;
		}
		if ( objPt._pos.x > objRec._pos.x + objRec._cornerX + objRec._width ) {
			return false;
		}
		if ( objPt._pos.y < objRec._pos.y + objRec._cornerY ) {
			return false;
		}
		if ( objPt._pos.y > objRec._pos.y + objRec._cornerY + objRec._height ) {
			return false;
		}
		return true;
	};
	var calcCircleVsCircle = function ( objCir0, objCir1 ) {
		if ( objCir0._pos.minus( objCir1._pos ).mag() < objCir0._radius + objCir1._radius ) {
			return true;
		}
		return false;
	};
	var calcRectVsRect = function ( objRec0, objRec1 ) {
		if ( objRec0._pos.x + objRec0._cornerX + objRec0._width < objRec1._pos.x + objRec1._cornerX ) {
			return false;
		}
		if ( objRec0._pos.x + objRec0._cornerX > objRec1._pos.x + objRec1._cornerX + objRec1._width ) {
			return false;
		}
		if ( objRec0._pos.y + objRec0._cornerY + objRec0._height < objRec1._pos.y + objRec1._cornerY ) {
			return false;
		}
		if ( objRec0._pos.y + objRec0._cornerY > objRec1._pos.y + objRec1._cornerY + objRec1._height ) {
			return false;
		}
		return true;
	};
	
	var map = {};
	
	map['Plane2D'] = {};
	map['Plane2D_Cirle'] = {};
	map['Plane2D_Rect'] = {};
	
	map['Plane2D']['Plane2D_Cirle'] = calcPointVsCircle;
	map['Plane2D']['Plane2D_Rect'] = calcPointVsCircle;
	map['Plane2D_Cirle']['Plane2D_Cirle'] = calcCircleVsCircle;
	map['Plane2D_Rect']['Plane2D_Rect'] = calcRectVsRect;
	
	var calc = function ( obj0, obj1 ) {
		var tag0 = obj0.getTag();
		var tag1 = obj1.getTag();
		var pre = map[tag0];
		var func;
		if ( !pre ) {
			pre = map[tag1];
			if ( !pre ) {
				return false;
			}
			func = pre[tag0];
			if ( !func ) {
				return false;
			}
			return func( obj1, obj0 );
		}
		
		func = pre[tag1];
		if ( !func ) {
			return false;
		}
		return func( obj0, obj1 );
	};
	
	inst.calc = calc;
	return inst;
} ());

var GravityItem = buildClass({
	  TAG: 'GravityItem'
	, _pos: null
	, _vec: null
	, _mass: 0
	, _radius: 0
	, _impVec: null
	, constructor: function ( pos, vec, mass, radius ) {
		this._pos = Vec2.createFromObj( pos );
		this._vec = Vec2.createFromObj( vec );
		this._mass = setter.setNum( mass, 0, { min: 0 } );
		this._radius = setter.setNum( radius, 0, { min: 0 } );
		this.init();
	}
	, init: function () {
		;
	}
	, dispose: function () {
		;
	}
	, getMass: function () {
		return this._mass;
	}
	, getPos: function () {
		return this._pos;
	}
	, getVec: function () {
		return this._vec;
	}
	, accelerate: function ( value ) {
		this._vec.addEql( value );
	}
	, preCalc: function () {
		this._impVec = null;
	}
	// value: unit vector
	, blockDir: function ( value ) {
		var testDir = this._impVec;
		if ( testDir === null ) {
			testDir = this._vec;
		}
		
		// same dir, no block
		var testDot = testDir.dot( value );
		if ( testDot >= 0 ) {
			return;
		}
		
		if ( this._impVec !== null ) {
			this._impVec = new Vec2();
			return;
		}
		
		var minusVec = value.mul( testDot );
		this._impVec = this._vec.minus( minusVec );
	}
	, isOverlap: function ( pos0, pos1, dist ) {
		return ( (pos0.x - pos1.x) * (pos0.x - pos1.x) + (pos0.y - pos1.y) * (pos0.y - pos1.y) < dist * dist );
	}
	, isCloseTo: function ( pos0, pos1, vec0, vec1 ) {
		var dir0 = pos1.minus( pos0 );
		var dir1 = vec0.minus( vec1 );
		return ( dir0.dot( dir1 ) > 0 );
	}
	, collide: function ( target ) {
		if ( this._mass + target._mass <= 0 ) {
			return;
		}
		if ( !this.isOverlap( this._pos, target._pos, this._radius + target._radius ) ) {
			return;
		}
		if ( !this.isCloseTo( this._pos, target._pos, this._vec, target._vec ) ) {
			return;
		}
		var dir = target._pos.minus( this._pos ).normalize();
		var speed0 = this._vec.dot( dir );
		var speed1 = target._vec.dot( dir );
		var speedAfter0 = ( speed0 * ( 0 + this._mass - target._mass ) + 2 * target._mass * speed1 ) / ( this._mass + target._mass );
		var speedAfter1 = ( speed1 * ( 0 - this._mass + target._mass ) + 2 *   this._mass * speed0 ) / ( this._mass + target._mass );
		this._vec.addEql( dir.mul( speedAfter0 - speed0 ) );
		target._vec.addEql( dir.mul( speedAfter1 - speed1 ) );
	}
	, collideSurface: function ( pos, dir ) {
		var distVec = this._pos.minus( pos );
		var dist = distVec.dot( dir );
		if ( dist >= this._radius ) {
			return;
		}
		
		var minusMag = this._vec.dot( dir );
		var addVec = dir.mul( -2 * minusMag );
		this._vec.addEql( addVec );
	}
	, limitSpeed: function ( value ) {
		if ( value <= 0 ) {
			this._vec = new Vec2();
			return;
		}
		var mag = this._vec.mag();
		if ( mag > value ) {
			this._vec.normalize();
			this._vec.mulEql( value );
		}
	}
	, blockFromItem: function ( target ) {
		if ( !this.isOverlap( this._pos, target._pos, this._radius + target._radius ) ) {
			return;
		}
		this.blockDir( this._pos.minus( target._pos ).normalize() );
	}
	// dir: unit vector
	, blockFromSurface: function ( pos, dir ) {
		var distVec = this._pos.minus( pos );
		var dist = distVec.dot( dir );
		if ( dist >= this._radius ) {
			return;
		}
		this.blockDir( dir );
	}
	, impCalc: function () {
		if ( this._impVec === null ) {
			this._pos.addEql( this._vec );
		} else {
			this._pos.addEql( this._impVec );
		}
	}
});

var GravityForce = buildClass({
	  TAG: 'GravityForce'
	, constructor: function () {
		this.init();
	}
	, init: function () {
		;
	}
	, dispose: function () {
		;
	}
	, calcAcc: function ( pos, mass ) {
		return new Vec2();
	}
});

var GravityForce_Point = buildClass({
	  TAG: 'GravityForce_Point'
	, superClass: GravityForce
	, _pos: null
	, _mag: 0
	, _isConst: false
	, constructor: function ( pos, mag, isConst ) {
		this._pos = Vec2.createFromObj( pos );
		this._mag = setter.setNum( mag, 0 );
		this._isConst = setter.setBool( isConst, false );
		this.init();
	}
	, init: function () {
		;
	}
	, dispose: function () {
		this._pos = null;
	}
	, calcAcc: function ( pos, mass ) {
		var rslt = new Vec2();
		if ( this._pos === null ) {
			return rslt;
		}
		
		rslt = this._pos.minus( pos ).normalize().mul( this._mag );
		if ( !this._isConst ) {
			if ( mass === 0 ) {
				rslt = new Vec2();
			} else {
				rslt.divEql( mass );
			}
		}
		
		return rslt;
	}
});

var GravityForce_Earth = buildClass({
	  TAG: 'GravityForce_Earth'
	, superClass: GravityForce
	, _force: null
	, _isConst: false
	, constructor: function ( force, isConst ) {
		this._force = Vec2.createFromObj( force );
		this._isConst = setter.setBool( isConst, false );
		this.init();
	}
	, init: function () {
		;
	}
	, dispose: function () {
		this._force = null;
	}
	, calcAcc: function ( pos, mass ) {
		var rslt = new Vec2();
		if ( this._force === null ) {
			return rslt;
		}
		
		rslt = this._force.clone();
		if ( !this._isConst ) {
			if ( mass === 0 ) {
				rslt = new Vec2();
			} else {
				rslt.divEql( mass );
			}
		}
		
		return rslt;
	}
});

var GravityWorld = buildClass({
	  TAG: 'GravityWorld'
	, _x: 0
	, _y: 0
	, _w: 0
	, _h: 0
	, _maxSpeed: 0
	, _force: null
	, _child: null
	, _signal: null
	, _timer: null
	, constructor: function () {
		this.init();
	}
	, init: function () {
		var self = this;
		
		this._child = [];
		
		this._force = [];
		
		this._signal = new Signal();
		
		this._timer = TimeCore.timer( function ( diff ) {
			self.run( diff );
		}, 1 );
		this._timer.run();
	}
	, dispose: function () {
		this._child = null;
		if ( this._signal !== null ) {
			this._signal.dispose();
			this._signal = null;
		}
		if ( this._timer !== null ) {
			this._timer.dispose();
			this._timer = null;
		}
	}
	, setMaxSpeed: function ( value ) {
		this._maxSpeed = setter.setNum( value, 0, { min: 0 } );
	}
	, setRect: function ( x, y, w, h ) {
		this._x = setter.setInt( x, 0, { min: 0 } );
		this._y = setter.setInt( y, 0, { min: 0 } );
		this._w = setter.setInt( w, 0, { min: 0 } );
		this._h = setter.setInt( h, 0, { min: 0 } );
	}
	, addForce: function ( obj ) {
		if ( this._force === null ) {
			return -1;
		}
		if ( !setter.isValidObj( obj ) ) {
			return -1;
		}
		
		var id = this._force.length;
		this._force.push( obj );
		return id;
	}
	, addItem: function ( obj ) {
		if ( this._child === null ) {
			return -1;
		}
		if ( !setter.isValidObj( obj ) ) {
			return -1;
		}
		
		var id = this._child.length;
		this._child.push( obj );
		return id;
	}
	, collision: function ( child0, child1 ) {
		child0.collide( child1 );
	}
	, blockCheck: function ( child0, child1 ) {
		child0.blockFromItem( child1 );
		child1.blockFromItem( child0 );
	}
	, run: function ( diff ) {
		var i = 0;
		var j = 0;
		var item = null;
		var force = null;
		
		// preCalc
		for(i = 0; i < this._child.length; i++) {
			item = this._child[i];
			item.preCalc();
		}
		
		// force
		for(j = 0; j < this._force.length; j++) {
			force = this._force[j];
			for(i = 0; i < this._child.length; i++) {
				item = this._child[i];
				var accVtr = force.calcAcc( item.getPos(), item.getMass() );
				item.accelerate( accVtr );
			}
		}
		
		// collision
		looper.pairs( this._child, this.collision );
		for(i = 0; i < this._child.length; i++) {
			item = this._child[i];
			item.collideSurface( new Vec2( this._x, this._y + this._h * 0.5 ), new Vec2( 1, 0 ) );
			item.collideSurface( new Vec2( this._x + this._w, this._y + this._h * 0.5 ), new Vec2( -1, 0 ) );
			item.collideSurface( new Vec2( this._x + this._w * 0.5, this._y ), new Vec2( 0, 1 ) );
			item.collideSurface( new Vec2( this._x + this._w * 0.5, this._y + this._h ), new Vec2( 0, -1 ) );
		}
		
		// limitSpeed
		for(i = 0; i < this._child.length; i++) {
			item = this._child[i];
			item.limitSpeed( this._maxSpeed );
		}
		
		// blockCheck
		looper.pairs( this._child, this.blockCheck );
		for(i = 0; i < this._child.length; i++) {
			item = this._child[i];
			item.blockFromSurface( new Vec2( this._x, this._y + this._h * 0.5 ), new Vec2( 1, 0 ) );
			item.blockFromSurface( new Vec2( this._x + this._w, this._y + this._h * 0.5 ), new Vec2( -1, 0 ) );
			item.blockFromSurface( new Vec2( this._x + this._w * 0.5, this._y ), new Vec2( 0, 1 ) );
			item.blockFromSurface( new Vec2( this._x + this._w * 0.5, this._y + this._h ), new Vec2( 0, -1 ) );
		}
		
		// impCalc
		for(i = 0; i < this._child.length; i++) {
			item = this._child[i];
			item.impCalc();
		}
		
		
		for(i = 0; i < this._child.length; i++) {
			item = this._child[i];
			var pos = item.getPos();
			this._signal.dispatch( { id: i, x: pos.x, y: pos.y, vec: item.getVec().clone() } );
		}
	}
	, getSignal: function () {
		return this._signal;
	}
});

////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////
////////////////////
//	UI
////////////////////
////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////

var GlobalSignal = (function () {
	var instance = {};
	
	var mouseMove = new Signal();
	var mouseUp = new Signal();
	
	document.body.onmousemove = function ( e ) {
		mouseMove.dispatch( e );
	};
	
	document.body.onmouseup = function ( e ) {
		mouseUp.dispatch( e );
	};
	
	instance.mouseMove = mouseMove;
	instance.mouseUp = mouseUp;
	
	return instance;
} ());

var DisplayObject = buildClass({
	  TAG: 'DisplayObject'
	, _inst: null
	, _type: ''
	, _posX: 0
	, _posY: 0
	, _dragable: null
	, constructor: function ( type ) {
		this._type = type;
		this.init();
	}
	, init: function () {
		this._inst = document.createElement( this._type );
		this._inst.style.position = "absolute";
		this._inst.style.left = 0;
		this._inst.style.top = 0;
		this._inst.style.transformOrigin = "0 0";
	}
	, dispose: function () {
		this._inst = null;
	}
	, getInst: function () {
		return this._inst;
	}
	, getPosX: function () {
		return this._posX;
	}
	, getPosY: function () {
		return this._posY;
	}
	, setPosX: function ( x ) {
		this._posX = setter.setInt( x, this._posX );
		this._inst.style.left = this._posX;
	}
	, setPosY: function ( y ) {
		this._posY = setter.setInt( y, this._posY );
		this._inst.style.top = this._posY;
	}
	, getDragable: function () {
		if ( this._dragable === null ) {
			this._dragable = new Dragable( this );
		}
		return this._dragable;
	}
});

var DragManager = (function () {
	var instance = {};
	
	var dragTarget = null;
	var dragX = 0;
	var dragY = 0;
	
	GlobalSignal.mouseMove.add( function ( e ) {
		/*
		if ( e.buttons === 0 ) {
			dragTarget = null;
		}
		*/
		
		if ( dragTarget === null ) {
			return;
		}
		
		dragTarget.update( e.pageX - dragX, e.pageY - dragY );
	});
	
	GlobalSignal.mouseUp.add( function ( e ) {
		dragTarget = null;
	});
	
	var setTarget = function ( dragable, e ) {
		dragTarget = dragable;
		var pos = dragTarget.getPos();
		dragX = e.pageX - pos.x;
		dragY = e.pageY - pos.y;
	};
	
	var unsetTarget = function ( dragable ) {
		if ( dragTarget === dragable ) {
			dragTarget = null;
		}
	};
	
	instance.setTarget = setTarget;
	instance.unsetTarget = unsetTarget;
	
	return instance;
} ());

var Dragable = buildClass({
	  TAG: 'Dragable'
	, _inst: null
	, _signal: null
	, constructor: function ( inst ) {
		this._inst = inst;
		this.init();
	}
	, init: function () {
		this._signal = new Signal();
	}
	, dispose: function () {
		this._inst = null;
		if ( this._signal !== null ) {
			this._signal.dispose();
			this._signal = null;
		}
	}
	, getInst: function () {
		return this._inst;
	}
	, getPos: function () {
		return { x: this._inst.getPosX(), y: this._inst.getPosY() };
	}
	, setPos: function ( x, y ) {
		this._x = x;
		this._y = y;
	}
	, getSignal: function () {
		return this._signal;
	}
	, enable: function ( value ) {
		var self = this;
		if ( value ) {
		//	self._inst.getInst().style.pointerEvents = "none";
			self._inst.getInst().style.userSelect = 'none';
			self._inst.getInst().style.userDrag = 'none';
			self._inst.getInst().onselectstart = function () { return false; };
			self._inst.getInst().ondragstart = function () { return false; };
			
			self._inst.getInst().onmousedown = function ( e ) {
				DragManager.setTarget( self, e );
			};
		} else {
			DragManager.unsetTarget( self );
			self._inst.getInst().onmousedown = null;
		}
	}
	, stop: function () {
		this._x = this._inst.getPosX();
		this._y = this._inst.getPosY();
	}
	, update: function ( x, y ) {
		this.setPos( x, y );
		this._signal.dispatch( { target: this, x: x, y: y } );
		this._inst.setPosX( this._x );
		this._inst.setPosY( this._y );
	}
});

var Quad = buildClass({
	  TAG: 'Quad'
	, superClass: DisplayObject
	, _width: 0
	, _height: 0
	, _color: ''
	, _alpha: 0
	, constructor: function ( width, height, color, alpha ) {
		this._width = setter.setInt( width, 0, { min: 0 } );
		this._height = setter.setInt( height, 0, { min: 0 } );
		this._color = setter.setStr( color );
		this._alpha = setter.setNum( alpha, 1, { min: 0, max: 1 } );
		Quad.__super__.constructor.apply( this, ['div'] );
	}
	, init: function () {
		Quad.__super__.init.apply( this, arguments );
		this._inst.style.width = this._width;
		this._inst.style.height = this._height;
		this._inst.style.backgroundColor = this._color;
	}
	, dispose: function () {
		Quad.__super__.dispose.apply( this, arguments );
	}
	, setColor: function ( value ) {
		this._color = setter.setStr( value );
		this._inst.style.backgroundColor = this._color;
	}
});

var BaseObject = buildClass({
	  TAG: 'BaseObject'
	, _inst: null
	, constructor: function ( inst ) {
		if ( !setter.isValidObj( inst ) ) {
			this.err( 'No inst' );
			return;
		}
		this._inst = inst;
		this.init();
	}
	, init: function () {
		;
	}
	, dispose: function () {
		this._inst = null;
	}
	, getInst: function () {
		return this._inst;
	}
});

var ProjctA = buildClass({
	  TAG: 'ProjctA'
	, _inst: null
	, _parent: null
	, _circleMap: null
	, constructor: function ( parent ) {
		if ( !setter.isValidObj( parent ) ) {
			this.err( 'No parent' );
			return;
		}
		this._parent = parent;
		this.init();
	}
	, init: function () {
		var self = this;
		
		this._inst = new Quad( 0, 0, '#000000' );
		this._parent.appendChild( this._inst.getInst() );
		
		var quad = new Quad( 100, 100, '#ff0000' );
		quad.setPosX( 50 );
		quad.setPosY( 50 );
		quad.getDragable().enable( true );
		this._inst.getInst().appendChild( quad.getInst() );
		
		quad.getDragable().getSignal().add( function ( rslt ) {
			var target = rslt.target;
			var x = rslt.x;
			var y = rslt.y;
			if ( x > 1000 && x > target.getInst().getPosX() ) {
				target.stop();
			}
		});
		
		/*
		var angle = 0;
		var speed = 0.0005;

		var t = TimeCore.timer( function ( diff ) {
		//	log( diff );
			angle += ( speed ) % 1;
			var s = Math.sin( angle * Math.PI * 2 );
			var c = Math.cos( angle * Math.PI * 2 );
			sp.getInst().style.transform = "matrix(" + c + "," + s + "," + (-s) + "," + c + ",0,0)";
		}, 1 );
		// t.run();
		*/
		this._circleMap = {};
		
		var world = new GravityWorld();
		world.setRect( 0, 0, 960, 580 );
		world.setMaxSpeed( 5 );
		world.getSignal().add( function ( data ) {
			self.updateCircle( data );
		});
		
		world.addForce( new GravityForce_Point( { x: 480, y: 290 }, 0.05, true ) );
	//	world.addForce( new GravityForce_Point( { x: 200, y: 200 }, 0.05, true ) );
	//	world.addForce( new GravityForce_Point( { x: 600, y: 600 }, 0.05, true ) );
	//	world.addForce( new GravityForce_Earth( { x: 0, y: 0.05 }, true ) );
		
		for(var i = 0; i < 1; i++) {
			var item = new GravityItem( { x: 50 + Math.random() * 860, y: 50 + Math.random() * 480 },  { x: Math.random() * 3, y: Math.random() * 3 }, 1, 5 );
			var id = world.addItem( item );
			var circle = new Quad( 10, 10, '#888888' );
			this._inst.getInst().appendChild( circle.getInst() );
			this._circleMap[id] = circle;
		}
	}
	, dispose: function () {
		this._inst = null;
		this._parent = null;
	}
	, updateCircle: function ( data ) {
		var id = data.id;
		var x = data.x;
		var y = data.y;
		var vec = data.vec;
		var circle = this._circleMap[id];
		circle.setPosX( x - 5 );
		circle.setPosY( y - 5 );
		
		var c = Math.floor( (1 - vec.mag() / 5) * 100 );
		var cStr = "rgb(" + c + "%," + c + "%," + c + "%)";
	//	this.log( cStr );
		circle.setColor( cStr );
	}
});

var Image = buildClass({
	  TAG: 'Image'
	, superClass: DisplayObject
	, _url: ''
	, constructor: function ( url ) {
		this._url = setter.setStr( url, '' );
		Image.__super__.constructor.apply( this, ['img'] );
	}
	, init: function () {
		Image.__super__.init.apply( this, arguments );
		log( 'set img >> ' +  this._url );
		this._inst.src = this._url;
	}
	, dispose: function () {
		Image.__super__.dispose.apply( this, arguments );
	}
});

var Drawer2D = buildClass({
	  TAG: 'Drawer2D'
	, superClass: DisplayObject
	, _width: 0
	, _height: 0
	, constructor: function ( width, height ) {
		this._width = setter.setInt( width, 0, { min: 0 } );
		this._height = setter.setInt( height, 0, { min: 0 } );
		Drawer2D.__super__.constructor.apply( this, ['canvas'] );
	}
	, init: function () {
		Drawer2D.__super__.init.apply( this, arguments );
		this._inst.width = this._width;
		this._inst.height = this._height;
	}
	, dispose: function () {
		Drawer2D.__super__.dispose.apply( this, arguments );
	}
	, clear: function () {
		var ctx = this._inst.getContext( '2d' );
		ctx.clearRect( 0, 0, this._inst.width, this._inst.height );
	}
	, drawCircle: function ( x, y, radius ) {
		var ctx = this._inst.getContext( '2d' );
		ctx.beginPath();
		ctx.arc( x, y, radius - 1, 0, 2 * Math.PI );
		ctx.stroke();
	}
	, drawRect: function ( x, y, width, height ) {
		var ctx = this._inst.getContext( '2d' );
		ctx.beginPath();
		ctx.rect( x + 0.5, y + 0.5, width - 1, height - 1 );
		ctx.stroke();
	}
	, getImage: function () {
		var dataUrl = this._inst.toDataURL();
		var img = new Image( dataUrl );
		return img;
	}
	, resize: function ( width, height ) {
		this._width = setter.setInt( width, 0, { min: 0 } );
		this._height = setter.setInt( height, 0, { min: 0 } );
		this._inst.width = this._width;
		this._inst.height = this._height;
	}
});

var ProjctOverlapTest = buildClass({
	  TAG: 'ProjctOverlapTest'
	, _inst: null
	, _parent: null
	, constructor: function ( parent ) {
		if ( !setter.isValidObj( parent ) ) {
			this.err( 'No parent' );
			return;
		}
		this._parent = parent;
		this.init();
	}
	, init: function () {
		var self = this;
		
		this._inst = new Quad( 0, 0, '#000000' );
		this._parent.appendChild( this._inst.getInst() );
		
		var drawer = new Drawer2D( 300, 150 );
		drawer.resize( 40, 40 );
		drawer.drawCircle( 20, 20, 20 );
		drawer.clear();
		drawer.drawRect( 0, 0, 40, 40 );
		
		var img = drawer.getImage();
		img.setPosX( 200 );
		img.getDragable().enable( true );
		this._inst.getInst().appendChild( img.getInst() );
		
		this.log( 'ProjctOverlapTest init()' );
	}
	, dispose: function () {
		this._inst = null;
		this._parent = null;
	}
});

new ProjctOverlapTest( document.body );

 new ProjctA( document.body );

<!-- Notices -->
/*
to do -
	find children by name?
*/

<!-- Testing Area -->


/*
var num = 0;
var t = TimeCore.timer( function ( diff ) {
	num++;
	if ( num > 200 )
	{
		t.stop();
	}
	console.log( TimeCore.time() + " - " + diff + " " + num );
}, 50 );
t.run();
*/

/*
var aniObj = {};
aniObj['testObj'] = 0;

log( "Testing A" );

tools.ifExistDo( aniObj, 'testObj', function ( obj ) {
	log( "Testing B" );
});

var mainView = document.createElement( 'div' );
document.body.appendChild( mainView );
var assets = getChildById( document.body, 'assets' );
var btn = getChildById( assets, 'btn' );
var newBtn = btn.cloneNode(true);
newBtn.id = 'aaa';
mainView.appendChild( newBtn );
*/
</script>
</html>